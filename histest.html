<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">
<script src="/script/jquery.min.js" type="text/javascript"></script>
<script>
var x = 41;
var odiv = null;

function display(s)
{
   var current = odiv.html();
   if (current.length) current += "<br>";
   odiv.html(current+s);
}

function pushState()
{
   x++;
   var state = { a: 0 }
   state.a = x;
   var url = $('#theurl').val();
   history.pushState(state, "", url+x);
   display("Push:- "+JSON.stringify(history.state));
}

function investigate(es)
{
   var stacktop = JSON.stringify(history.state);
   var popped = JSON.stringify(es);
   display("Back:- stacktop "+stacktop+" popped "+popped);
}

$(function() {
   window.onpopstate = function(event) { investigate(event.state); };
   odiv = $('#output');
   display("Loaded");
   display(JSON.stringify(history.state));
   $('#theurl').val("#whatever");
});
</script>
</head>
<body>
<input type="text" id="theurl"/> Enter the URL for the push here.<br>
<button type="button" id="go" onclick="pushState();">Push a state</button><p>
Push entries show history.state, Back entries (press the back button) show history.state (stacktop), and whatever
we got from the window.onpopstate handler.<p>
<div id="output" style="border:solid 1px black; width 100%; height:20em; overflow-y:scroll;"></div>
</body>
</html>
